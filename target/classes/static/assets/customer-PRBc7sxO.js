var f=Object.defineProperty;var b=(o,r,t)=>r in o?f(o,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[r]=t;var m=(o,r,t)=>b(o,typeof r!="symbol"?r+"":r,t);import{R as N,j as e}from"./index-99f8L1Mz.js";import{a as C}from"./axios-Bf4ed8-h.js";import{C as k,a as y}from"./CRow-CQDHG5PP.js";import{C as P,a as S}from"./CCardBody-D9eOIBUj.js";import{C as v}from"./CCardHeader-B47WjFw8.js";import{a as g}from"./index.esm-BCRkz77e.js";import{C as T,a as L,b as p,c as l,d as M,e as c}from"./CTable-UXoEovni.js";import{P as D}from"./Pagination-DqexyvrL.js";import{C as I,a as w,b as A,c as R,d as U}from"./CModalTitle-YkCcU6py.js";import{C as F}from"./CForm-CO1zHbKf.js";import{C as d}from"./CFormLabel-67YmB8XI.js";import{C as u}from"./CFormInput-cAnInhAJ.js";import{C as _}from"./CFormSelect-DJlOjOeb.js";import"./DefaultLayout-Djq4LQ4p.js";import"./cil-user-Dlmw-Gem.js";import"./CFormControlWrapper-fBUjcULM.js";import"./CFormControlValidation-ByQ94D8b.js";const x="http://localhost:8080/api/customers";class ${getCustomer(){return C.get(`${x}/getall`)}getCustomerAtPage(r){return C.get(`${x}/getCustomerPage?page=${r}`)}}const H=new $;class ae extends N.Component{constructor(t){super(t);m(this,"handlePageChange",(t,a)=>{this.setState({currentPage:a}),this.fetchCustomers(a)});m(this,"toggleModal",(t=null)=>{this.setState(a=>({showModal:!a.showModal,editCustomer:t,newCustomer:t||{id:"",fullName:"",birthDate:"",phoneNumber:"",email:"",gender:""}}))});m(this,"handleInputChange",t=>{const{name:a,value:h}=t.target;this.setState(i=>({newCustomer:{...i.newCustomer,[a]:h}}))});m(this,"handleSave",()=>{const{newCustomer:t,editCustomer:a}=this.state,h={id:9999,fullName:t.fullName,birthDate:t.birthDate,phoneNumber:t.phoneNumber,email:t.email,gender:t.gender,status:1};if(t.fullName===""){alert("Vui lòng nhập họ tên");return}if(t.birthDate===""){alert("Vui lòng nhập ngày sinh");return}if(t.phoneNumber===""){alert("Vui lòng nhập số điện thoại");return}if(t.email===""){alert("Vui lòng nhập email");return}if(t.gender===""){alert("Vui lòng nhập giới tính");return}a?(alert("Sửa thông tin khách hàng: "+JSON.stringify(h)),console.log("Sửa thông tin khách hàng",h),fetch(`http://localhost:8080/api/customers/update/${a.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)}).then(n=>{console.log("data trả về nè",n),n.ok?(alert("Sửa thông tin khách hàng thành công rồi nè"),this.toggleModal(),this.fetchCustomers(this.state.currentPage)):(alert("Có lỗi xảy ra khi sửa thông tin ở trong"),console.error("Lỗi sửa thông tin:",n))}).catch(n=>{alert("Có lỗi xảy ra khi sửa thông tin"),console.error("Lỗi sửa thông tin:",n)})):(alert("Thêm thông tin khách hàng"+JSON.stringify(h)),console.log("Thêm thông tin khách hàng",h),fetch("http://localhost:8080/api/customers/add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)}).then(n=>{console.log("data trả về nè",n),n.ok?(alert("Thêm thông tin khách hàng thành công rồi nè"),this.toggleModal(),this.fetchCustomers(this.state.currentPage)):(alert("Có lỗi xảy ra khi thêm thông tin khách hàng ở trong"),console.error("Lỗi thêm thông tin khách hàng:",n))}).catch(n=>{alert("Có lỗi xảy ra khi thêm thông tin khách hàng"),console.error("Lỗi thêm thông tin khách hàng:",n)}))});m(this,"handleDelete",t=>{fetch(`http://localhost:8080/api/customers/updateStatus/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:0})}).then(h=>{console.log("Response:",h),h.ok?(alert("Xóa thông tin khách hàng thành công rồi nè"),this.fetchCustomers(this.state.currentPage)):(alert("Có lỗi xảy ra khi xóa thông tin khách hàng"),console.error("Lỗi xóa thông tin khách hàng:",h))}).catch(h=>{alert("Có lỗi xảy ra khi xóa thông tin khách hàng"),console.error("Lỗi xóa thông tin khách hàng:",h)})});this.state={customers:[],currentPage:1,pageLimit:0,perPage:5,editCustomer:null,showModal:!1,newCustomer:{id:"",fullName:"",birthDate:"",phoneNumber:"",email:"",gender:""}}}componentDidMount(){this.fetchCustomers(1)}fetchCustomers(t){H.getCustomerAtPage(t).then(a=>{const{data:h}=a,i=h.filter(s=>s.status===1),n=Math.ceil(i.length/this.state.perPage);this.setState({customers:i,pageLimit:n})}).catch(a=>{console.error("Lỗi fetch customers:",a)})}render(){const{customers:t,currentPage:a,pageLimit:h,showModal:i,newCustomer:n}=this.state;return Array.isArray(t)?e.jsxs(k,{children:[e.jsx(y,{children:e.jsxs(P,{children:[e.jsxs(v,{children:["Customer Information",e.jsx(g,{color:"primary",className:"float-end",onClick:()=>this.toggleModal(),children:"Thêm khách hàng"})]}),e.jsxs(S,{children:[e.jsxs(T,{children:[e.jsx(L,{children:e.jsxs(p,{children:[e.jsx(l,{children:"Mã khách hàng"}),e.jsx(l,{children:"Họ tên"}),e.jsx(l,{children:"Giới tính"}),e.jsx(l,{children:"Ngày sinh"}),e.jsx(l,{children:"Số điện thoại"}),e.jsx(l,{children:"Email"}),e.jsx(l,{children:"Hành động"})]})}),e.jsx(M,{children:t.map((s,j)=>e.jsxs(p,{children:[e.jsx(c,{children:s.id}),e.jsx(c,{children:s.fullName}),e.jsx(c,{children:s.gender}),e.jsx(c,{children:s.birthDate}),e.jsx(c,{children:s.phoneNumber}),e.jsx(c,{children:s.email}),e.jsxs(c,{children:[e.jsx(g,{color:"warning",onClick:()=>this.toggleModal(s),children:"Sửa"}),e.jsx(g,{color:"danger",onClick:()=>this.handleDelete(s.id),children:"Xóa"})]})]},j))})]}),e.jsx(D,{count:h,page:a,onChange:this.handlePageChange,variant:"outlined",shape:"rounded"})]})]})}),e.jsxs(I,{visible:i,onClose:()=>this.toggleModal(),children:[e.jsx(w,{children:e.jsx(A,{children:this.state.editCustomer?"Chỉnh sửa thông tin khách hàng":"Thêm thông tin khách hàng"})}),e.jsx(R,{children:e.jsxs(F,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{htmlFor:"customerName",children:"Tên khách hàng"}),e.jsx(u,{type:"text",id:"customerName",name:"fullName",value:n.fullName,onChange:this.handleInputChange})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{htmlFor:"customerbirthDate",children:"Ngày sinh"}),e.jsx(u,{type:"text",id:"customerbirthDate",name:"birthDate",value:n.birthDate,onChange:this.handleInputChange})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{htmlFor:"customerPhoneNumber",children:"Số điện thoại"}),e.jsx(u,{type:"text",id:"customerPhoneNumber",name:"phoneNumber",value:n.phoneNumber,onChange:this.handleInputChange})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{htmlFor:"customerEmail",children:"Email"}),e.jsx(u,{type:"text",id:"customerEmail",name:"email",value:n.email,onChange:this.handleInputChange})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{htmlFor:"customerGender",children:"Giới tính"}),e.jsxs(_,{id:"customerGender",name:"gender",value:n.gender,onChange:this.handleInputChange,children:[e.jsx("option",{value:"",children:"Chọn giới tính"}),e.jsx("option",{value:"0",children:"Nam"}),e.jsx("option",{value:"1",children:"Nữ"})]})]})]})}),e.jsx(U,{children:e.jsx(g,{color:"primary",onClick:this.handleSave,children:this.state.editCustomer?"Cập nhật":"Lưu"})})]})]}):(console.error("Customers is not an array:",t),null)}}export{ae as default};
