var f=Object.defineProperty;var b=(i,s,t)=>s in i?f(i,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[s]=t;var m=(i,s,t)=>b(i,typeof s!="symbol"?s+"":s,t);import{R as N,j as e}from"./index-BpO_ZBpg.js";import{a as C}from"./axios-Bf4ed8-h.js";import{C as k,a as y}from"./CRow-Dqnfr_wj.js";import{C as P,a as S}from"./CCardBody-CMSQjRyN.js";import{C as L}from"./CCardHeader-mgkFoPN8.js";import{a as g}from"./index.esm-B7tri5ae.js";import{C as v,a as T,b as p,c as l,d as M,e as c}from"./CTable-Nm7DNUaS.js";import{P as D}from"./Pagination-BgrqAxMU.js";import{C as I,a as w,b as R,c as A,d as U}from"./CModalTitle-B6u3slLn.js";import{C as _}from"./CForm-slcMCCNs.js";import{C as d}from"./CFormLabel-DbKX5pXu.js";import{C as u}from"./CFormInput-tNvxg6rX.js";import{C as F}from"./CFormSelect-DAzVJejd.js";import"./DefaultLayout-DLZyO0-G.js";import"./cil-user-Dlmw-Gem.js";import"./CFormControlWrapper-DFY-SP3F.js";import"./CFormControlValidation-CSCRF9kd.js";const x="http://localhost:8080/api/customers";class ${getCustomer(){return C.get(`${x}/getall`)}getCustomerAtPage(s){return C.get(`${x}/getcustomerPage?page=${s}`)}}const O=new $;class ae extends N.Component{constructor(t){super(t);m(this,"handlePageChange",(t,a)=>{this.setState({currentPage:a}),this.fetchCustomers(a)});m(this,"toggleModal",(t=null)=>{this.setState(a=>({showModal:!a.showModal,editCustomer:t,newCustomer:t||{id:"",fullName:"",birthDate:"",phoneNumber:"",email:"",gender:""}}))});m(this,"handleInputChange",t=>{const{name:a,value:n}=t.target;this.setState(o=>({newCustomer:{...o.newCustomer,[a]:n}}))});m(this,"handleSave",()=>{const{newCustomer:t,editCustomer:a}=this.state,n={id:9999,fullName:t.fullName,birthDate:t.birthDate,phoneNumber:t.phoneNumber,email:t.email,gender:t.gender,status:1};if(t.fullName==""){alert("Vui lòng nhập họ tên");return}if(t.birthDate==""){alert("Vui lòng nhập ngày sinh");return}if(t.phoneNumber==""){alert("Vui lòng nhập số điện thoại");return}if(t.email==""){alert("Vui lòng nhập email");return}if(t.gender==""){alert("Vui lòng nhập giới tính");return}a?(alert("Sửa thông tin khách hàng: "+JSON.stringify(n)),console.log("Sửa thông tin khách hàng",n),fetch(`http://localhost:8080/api/customers/update/${a.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then(h=>{console.log("data trả về nè",h),h.ok?(alert("Sửa thông tin khách hàng thành công rồi nè"),this.toggleModal(),this.fetchcustomers(this.state.currentPage)):(alert("Có lỗi xảy ra khi sửa thông tin ở trong"),console.error("Lỗi sửa thông tin:",h))}).catch(h=>{alert("Có lỗi xảy ra khi sửa thông tin"),console.error("Lỗi sửa thông tin:",h)})):(alert("Thêm thông tin khách hàng"+JSON.stringify(n)),console.log("Thêm thông tin khách hàng",n),fetch("http://localhost:8080/api/customers/add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then(h=>{console.log("data trả về nè",h),h.ok?(alert("Thêm thông tin khách hàng thành công rồi nè"),this.toggleModal(),this.fetchcustomers(this.state.currentPage)):(alert("Có lỗi xảy ra khi thêm thông tin khách hàng ở trong"),console.error("Lỗi thêm thông tin khách hàng:",h))}).catch(h=>{alert("Có lỗi xảy ra khi thêm thông tin khách hàng"),console.error("Lỗi thêm thông tin khách hàng:",h)}))});m(this,"handleDelete",t=>{fetch(`http://localhost:8080/api/customers/updateStatus/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:0})}).then(n=>{console.log("Response:",n),n.ok?(alert("Xóa thông tin khách hàng thành công rồi nè"),this.fetchcustomers(this.state.currentPage)):(alert("Có lỗi xảy ra khi xóa thông tin khách hàng"),console.error("Lỗi xóa thông tin khách hàng:",n))}).catch(n=>{alert("Có lỗi xảy ra khi xóa thông tin khách hàng"),console.error("Lỗi xóa thông tin khách hàng:",n)})});this.state={customers:[],currentPage:1,pageLimit:0,perPage:5,editCustomer:null,showModal:!1,newCustomer:{id:"",fullName:"",birthDate:"",phoneNumber:"",email:"",gender:""}}}componentDidMount(){O.getCustomer().then(t=>{this.setState({customers:t.data})}).catch(t=>{console.error("Lỗi fetch customers:",t)}),this.fetchCustomers(1)}fetchCustomers(t){fetch("http://localhost:8080/api/customers/getall").then(n=>n.json()).then(n=>{const o=Math.ceil(n.length/this.state.perPage);this.setState({customers:n,pageLimit:o}),alert("Danh sach khach hang: "+JSON.stringify(n)),console.log("Danh sach khach hang: "+n)}).catch(n=>{console.error("Lỗi fetch customers:",n)})}render(){const{customers:t,currentPage:a,pageLimit:n,showModal:o,newCustomer:h}=this.state;return Array.isArray(t)?e.jsxs(k,{children:[e.jsx(y,{children:e.jsxs(P,{children:[e.jsxs(L,{children:["Customer Information",e.jsx(g,{color:"primary",className:"float-end",onClick:()=>this.toggleModal(),children:"Thêm khách hàng"})]}),e.jsxs(S,{children:[e.jsxs(v,{children:[e.jsx(T,{children:e.jsxs(p,{children:[e.jsx(l,{children:"Mã khách hàng"}),e.jsx(l,{children:"Họ tên"}),e.jsx(l,{children:"Giới tính"}),e.jsx(l,{children:"Ngày sinh"}),e.jsx(l,{children:"Số điện thoại"}),e.jsx(l,{children:"Email"}),e.jsx(l,{children:"Hành động"})]})}),e.jsx(M,{children:t.map((r,j)=>e.jsxs(p,{children:[e.jsx(c,{children:r.id}),e.jsx(c,{children:r.fullName}),e.jsx(c,{children:r.gender}),e.jsx(c,{children:r.birthDate}),e.jsx(c,{children:r.phoneNumber}),e.jsx(c,{children:r.email}),e.jsxs(c,{children:[e.jsx(g,{color:"warning",onClick:()=>this.toggleModal(r),children:"Sửa"}),e.jsx(g,{color:"danger",onClick:()=>this.handleDelete(r.id),children:"Xóa"})]})]},j))})]}),e.jsx(D,{count:n,page:a,onChange:this.handlePageChange,variant:"outlined",shape:"rounded"})]})]})}),e.jsxs(I,{visible:o,onClose:()=>this.toggleModal(),children:[e.jsx(w,{children:e.jsx(R,{children:this.state.editCustomer?"Chỉnh sửa thông tin khách hàng":"Thêm thông tin khách hàng"})}),e.jsx(A,{children:e.jsxs(_,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{htmlFor:"customerName",children:"Tên khách hàng"}),e.jsx(u,{type:"text",id:"customerName",name:"fullName",value:h.fullName,onChange:this.handleInputChange})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{htmlFor:"customerbirthDate",children:"Ngày sinh"}),e.jsx(u,{type:"text",id:"customerbirthDate",name:"birthDate",value:h.birthDate,onChange:this.handleInputChange})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{htmlFor:"customerPhoneNumber",children:"Số điện thoại"}),e.jsx(u,{type:"text",id:"customerPhoneNumber",name:"phoneNumber",value:h.phoneNumber,onChange:this.handleInputChange})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{htmlFor:"customerEmail",children:"Email"}),e.jsx(u,{type:"text",id:"customerEmail",name:"email",value:h.email,onChange:this.handleInputChange})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{htmlFor:"customerGender",children:"Giới tính"}),e.jsxs(F,{id:"customerGender",name:"gender",value:this.state.newCustomer.gender,onChange:this.handleInputChange,children:[e.jsx("option",{value:"Nam",children:"Nam"}),e.jsx("option",{value:"Nữ",children:"Nữ"})]})]})]})}),e.jsx(U,{children:e.jsx(g,{color:"primary",onClick:this.handleSave,children:this.state.editCustomer?"Cập nhật":"Lưu"})})]})]}):(console.error("Customers is not an array:",t),null)}}export{ae as default};
