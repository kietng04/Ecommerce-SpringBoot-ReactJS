var v=Object.defineProperty;var w=(n,a,t)=>a in n?v(n,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[a]=t;var d=(n,a,t)=>w(n,typeof a!="symbol"?a+"":a,t);import{R as S,j as e}from"./index-CU5s37LZ.js";import{C as A,a as T}from"./CRow-68EeHvkX.js";import{C as F,a as V}from"./CCardBody-DSOp1bls.js";import{C as E}from"./CCardHeader-i1VJ0kYh.js";import{a as c}from"./index.esm-onHWUeTl.js";import{C as j,a as f,b as h,c as r,d as C,e as l}from"./CTable-CfFfpXwt.js";import{C as g,a as D,b as P,c as y,d as I}from"./CModalTitle-BFKOXPi_.js";import{C as H}from"./CForm-L-31CGqP.js";import{C as m}from"./CFormSelect-BYPwgbTC.js";import{C as M}from"./CFormInput-u2mMy34l.js";import"./DefaultLayout-DbVadOT3.js";import"./cil-user-Dlmw-Gem.js";import"./CFormControlWrapper-CDEXgqvB.js";import"./CFormControlValidation-DlSmRgfU.js";import"./CFormLabel-CdUOF5-k.js";class Z extends S.Component{constructor(t){super(t);d(this,"fetchProducts",()=>{fetch("http://localhost:8080/api/products/getAllProductWithAllDetails").then(t=>t.json()).then(t=>{this.setState({products:t})}).catch(t=>{console.error("Error fetching products:",t)})});d(this,"fetchEmployees",()=>{fetch("http://localhost:8080/api/employees/current").then(t=>t.json()).then(t=>{console.log("API Response:",t),this.setState({formData:{...this.state.formData,employeeId:t.id,employeeName:t.name}},()=>{console.log("Updated state:",this.state.formData)})}).catch(t=>{console.error("Error:",t)})});d(this,"toggleAddModal",()=>{this.setState(t=>({showAddModal:!t.showAddModal,formData:{...t.formData,supplierId:"",employeeId:"",selectedProduct:{productId:"",productName:"",importPrice:0,exportPrice:0},selectedProducts:t.formData.selectedProducts}}))});d(this,"toggleViewModal",(t=null)=>{this.setState(i=>({showViewModal:!i.showViewModal,selectedImport:t}))});d(this,"handleAddProduct",()=>{const t=document.querySelector('select[name="product"]').value;if(!t)return;const i=this.state.products.find(o=>o.product.id.toString()===t);i&&this.setState(o=>({formData:{...o.formData,selectedProducts:[...o.formData.selectedProducts,{productId:t,productName:i.product.name,importPrice:this.state.formData.importPrice,exportPrice:this.state.formData.exportPrice}],importPrice:0,exportPrice:0}}))});d(this,"handleFormSubmit",t=>{t.preventDefault();const i={supplierId:this.state.formData.supplierId,employeeId:this.state.formData.employeeId,products:this.state.formData.selectedProducts};console.log("Form submitted:",i),this.toggleAddModal()});this.state={showAddModal:!1,showViewModal:!1,selectedImport:null,products:[],formData:{supplierId:"",employeeId:"",employeeName:"",importPrice:0,exportPrice:0,selectedProducts:[]}}}componentDidMount(){this.fetchEmployees(),this.fetchProducts()}render(){const{showAddModal:t,showViewModal:i,selectedImport:o}=this.state,{selectedProduct:u,selectedProducts:b}=this.state.formData,{products:x}=this.state,N=[{id:1,importDate:"2024-01-01",supplierId:"SUP001",employeeId:"EMP001",totalAmount:1e6}];return e.jsxs(A,{children:[e.jsx(T,{children:e.jsxs(F,{children:[e.jsxs(E,{children:["Import Product Information",e.jsx(c,{color:"primary",className:"float-end",onClick:this.toggleAddModal,children:"Thêm phiếu nhập"})]}),e.jsx(V,{children:e.jsxs(j,{children:[e.jsx(f,{children:e.jsxs(h,{children:[e.jsx(r,{children:"Mã phiếu nhập"}),e.jsx(r,{children:"Thời gian"}),e.jsx(r,{children:"Mã nhà cung cấp"}),e.jsx(r,{children:"Nhân viên"}),e.jsx(r,{children:"Tổng tiền"}),e.jsx(r,{children:"Hành động"})]})}),e.jsx(C,{children:N.map((s,p)=>e.jsxs(h,{children:[e.jsx(l,{children:s.id}),e.jsx(l,{children:s.importDate}),e.jsx(l,{children:s.supplierId}),e.jsx(l,{children:s.employeeId}),e.jsx(l,{children:s.totalAmount}),e.jsxs(l,{children:[e.jsx(c,{color:"info",onClick:()=>this.toggleViewModal(s),children:"Xem phiếu"}),e.jsx(c,{color:"danger",className:"ms-2",children:"Hủy phiếu"})]})]},p))})]})})]})}),e.jsxs(g,{visible:t,onClose:this.toggleAddModal,size:"lg",children:[e.jsx(D,{children:e.jsx(P,{children:"Thêm phiếu nhập"})}),e.jsx(y,{children:e.jsxs(H,{onSubmit:this.handleFormSubmit,children:[e.jsxs(m,{className:"mb-3",label:"Nhà cung cấp",value:this.state.formData.supplierId,onChange:s=>this.setState({formData:{...this.state.formData,supplierId:s.target.value}}),children:[e.jsx("option",{value:"",children:"Chọn nhà cung cấp"}),e.jsx("option",{value:"1",children:"Nhà cung cấp 1"})]}),e.jsx(m,{className:"mb-3",label:"Nhân viên",value:this.state.formData.employeeId||"",disabled:!0,children:e.jsx("option",{value:this.state.formData.employeeId||"",children:this.state.formData.employeeName||"No Employee Found"})}),e.jsxs("div",{className:"row mb-3",children:[e.jsx("div",{className:"col-3",children:e.jsxs(m,{children:[e.jsx("option",{value:"",children:"Chọn sản phẩm"}),x&&x.map(s=>e.jsx("option",{value:s.product.id,children:`${s.product.name} - Màu: ${s.details[0].color} - Size: ${s.details[0].size} - Số lượng: ${s.details[0].quantity}`},s.product.id))]})}),e.jsx("div",{className:"col-3",children:e.jsx(M,{type:"number",label:"Giá nhập",value:u.importPrice,onChange:s=>this.setState({formData:{...this.state.formData,importPrice:parseFloat(s.target.value)}})})}),e.jsx("div",{className:"col-3",children:e.jsx(M,{type:"number",label:"Giá xuất",value:u.exportPrice,onChange:s=>this.setState({formData:{...this.state.formData,exportPrice:parseFloat(s.target.value)}})})}),e.jsx("div",{className:"col-3 d-flex align-items-end",children:e.jsx(c,{color:"primary",onClick:this.handleAddProduct,children:"Thêm"})})]}),e.jsx("h6",{children:"Danh sách sản phẩm đã chọn"}),e.jsxs(j,{children:[e.jsx(f,{children:e.jsxs(h,{children:[e.jsx(r,{children:"Mã SP"}),e.jsx(r,{children:"Tên SP"}),e.jsx(r,{children:"Giá nhập"}),e.jsx(r,{children:"Giá xuất"})]})}),e.jsx(C,{children:b.map((s,p)=>e.jsxs(h,{children:[e.jsx(l,{children:s.productId}),e.jsx(l,{children:s.productName}),e.jsx(l,{children:s.importPrice}),e.jsx(l,{children:s.exportPrice})]},p))})]}),e.jsxs(I,{children:[e.jsx(c,{color:"secondary",onClick:this.toggleAddModal,children:"Đóng"}),e.jsx(c,{color:"primary",type:"submit",children:"Lưu"})]})]})})]}),e.jsxs(g,{visible:i,onClose:()=>this.toggleViewModal(),children:[e.jsx(D,{children:e.jsx(P,{children:"Chi tiết phiếu nhập"})}),e.jsx(y,{children:o&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:["Mã phiếu: ",o.id]}),e.jsxs("p",{children:["Thời gian: ",o.importDate]}),e.jsxs("p",{children:["Nhà cung cấp: ",o.supplierId]}),e.jsxs("p",{children:["Nhân viên: ",o.employeeId]}),e.jsxs("p",{children:["Tổng tiền: ",o.totalAmount]})]})}),e.jsx(I,{children:e.jsx(c,{color:"secondary",onClick:()=>this.toggleViewModal(),children:"Đóng"})})]})]})}}export{Z as default};
